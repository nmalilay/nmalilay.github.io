<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Will You Be My Valentine?</title>
  <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;600&family=Quicksand:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: linear-gradient(160deg, #fff5f7 0%, #ffe8ef 30%, #ffd6e0 60%, #fff0f5 100%);
      font-family: 'Quicksand', sans-serif;
      color: #5a3e4b;
      overflow-x: hidden;
      position: relative;
    }

    /* Sparkle cursor trail */
    .sparkle-trail {
      position: fixed;
      pointer-events: none;
      z-index: 9999;
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #ff85a1;
      box-shadow: 0 0 6px #ff85a1, 0 0 12px #ffc2d1;
      animation: sparkleFade 0.6s ease-out forwards;
    }

    @keyframes sparkleFade {
      0% { transform: scale(1); opacity: 1; }
      100% { transform: scale(0) translateY(-20px); opacity: 0; }
    }

    /* Floating bunnies */
    .floaters-bg {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 0;
    }

    .floating-bunny {
      position: absolute;
      bottom: -80px;
      opacity: 0;
      animation: floatUp linear infinite;
    }

    .mini-bunny {
      position: relative;
      width: 24px;
      height: 28px;
      background: #ffb6c1;
      border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
    }

    .mini-bunny::before, .mini-bunny::after {
      content: '';
      position: absolute;
      width: 8px;
      height: 18px;
      background: #ffb6c1;
      border-radius: 50%;
      top: -14px;
    }

    .mini-bunny::before { left: 3px; transform: rotate(-8deg); }
    .mini-bunny::after { right: 3px; transform: rotate(8deg); }

    .mini-bunny .ear-inner-l, .mini-bunny .ear-inner-r {
      position: absolute;
      width: 4px;
      height: 10px;
      background: #ff8fa3;
      border-radius: 50%;
      top: -11px;
      z-index: 1;
    }

    .mini-bunny .ear-inner-l { left: 5px; transform: rotate(-8deg); }
    .mini-bunny .ear-inner-r { right: 5px; transform: rotate(8deg); }

    @keyframes floatUp {
      0%   { transform: translateY(0) rotate(0deg); opacity: 0; }
      10%  { opacity: 0.45; }
      90%  { opacity: 0.45; }
      100% { transform: translateY(-110vh) rotate(15deg); opacity: 0; }
    }

    /* Soft orbs */
    .orb {
      position: fixed;
      border-radius: 50%;
      filter: blur(100px);
      opacity: 0.18;
      z-index: 0;
      animation: drift 14s ease-in-out infinite alternate;
    }

    .orb-1 { width: 400px; height: 400px; background: #ffb6c1; top: -100px; left: -100px; }
    .orb-2 { width: 350px; height: 350px; background: #98d4a2; bottom: -80px; right: -80px; animation-delay: -5s; }
    .orb-3 { width: 250px; height: 250px; background: #ffc2d1; top: 30%; left: 55%; animation-delay: -9s; }
    .orb-4 { width: 200px; height: 200px; background: #c9e8cd; top: 60%; right: 20%; animation-delay: -7s; }

    @keyframes drift {
      to { transform: translate(50px, 30px); }
    }

    /* Content */
    .content {
      position: relative;
      z-index: 1;
      text-align: center;
      padding: 2rem;
    }

    /* Keroppi */
    .keroppi {
      position: relative;
      width: 100px;
      height: 90px;
      margin: 0 auto 0.5rem;
      animation: hopHop 1.5s ease-in-out infinite;
    }

    .keroppi-body {
      width: 80px;
      height: 60px;
      background: #6abf69;
      border-radius: 50%;
      position: absolute;
      bottom: 0;
      left: 10px;
    }

    .keroppi-eye-l, .keroppi-eye-r {
      position: absolute;
      width: 28px;
      height: 28px;
      background: #fff;
      border-radius: 50%;
      top: -8px;
      border: 2px solid #3a7a39;
    }

    .keroppi-eye-l { left: 8px; }
    .keroppi-eye-r { right: 8px; }

    .keroppi-pupil-l, .keroppi-pupil-r {
      position: absolute;
      width: 12px;
      height: 14px;
      background: #1a1a2e;
      border-radius: 50%;
      top: 6px;
    }

    .keroppi-pupil-l { left: 14px; }
    .keroppi-pupil-r { right: 14px; }

    .keroppi-pupil-l::after, .keroppi-pupil-r::after {
      content: '';
      position: absolute;
      width: 4px;
      height: 4px;
      background: #fff;
      border-radius: 50%;
      top: 2px;
      left: 2px;
    }

    .keroppi-mouth {
      position: absolute;
      width: 30px;
      height: 12px;
      border-bottom: 3px solid #3a7a39;
      border-radius: 0 0 50% 50%;
      bottom: 16px;
      left: 25px;
    }

    .keroppi-cheek-l, .keroppi-cheek-r {
      position: absolute;
      width: 14px;
      height: 8px;
      background: #ff9eae;
      border-radius: 50%;
      bottom: 18px;
      opacity: 0.7;
    }

    .keroppi-cheek-l { left: 10px; }
    .keroppi-cheek-r { right: 10px; }

    @keyframes hopHop {
      0%, 100% { transform: translateY(0); }
      30%      { transform: translateY(-12px); }
      50%      { transform: translateY(0); }
      70%      { transform: translateY(-8px); }
    }

    /* Big bunny */
    .bunny {
      position: relative;
      width: 120px;
      height: 150px;
      margin: 0.5rem auto;
      animation: bunnyBounce 1.2s ease-in-out infinite;
      cursor: pointer;
    }

    .bunny:hover .bunny-cheek-l,
    .bunny:hover .bunny-cheek-r {
      opacity: 1;
      transform: scale(1.3);
    }

    .bunny-head {
      width: 100px;
      height: 90px;
      background: #fff;
      border-radius: 50%;
      position: absolute;
      bottom: 0;
      left: 10px;
      box-shadow: inset 0 -5px 15px rgba(255, 182, 193, 0.3);
    }

    .bunny-ear-l, .bunny-ear-r {
      position: absolute;
      width: 26px;
      height: 65px;
      background: #fff;
      border-radius: 50%;
      top: -45px;
      box-shadow: inset 0 0 10px rgba(255, 182, 193, 0.2);
    }

    .bunny-ear-l { left: 18px; transform: rotate(-12deg); }
    .bunny-ear-r { right: 18px; transform: rotate(12deg); }

    .bunny-ear-inner-l, .bunny-ear-inner-r {
      position: absolute;
      width: 12px;
      height: 40px;
      background: #ffb6c1;
      border-radius: 50%;
      top: -35px;
    }

    .bunny-ear-inner-l { left: 25px; transform: rotate(-12deg); }
    .bunny-ear-inner-r { right: 25px; transform: rotate(12deg); }

    .bunny-eye-l, .bunny-eye-r {
      position: absolute;
      width: 10px;
      height: 12px;
      background: #2d1b30;
      border-radius: 50%;
      bottom: 40px;
    }

    .bunny-eye-l { left: 32px; }
    .bunny-eye-r { right: 32px; }

    .bunny-eye-l::after, .bunny-eye-r::after {
      content: '';
      position: absolute;
      width: 3px;
      height: 3px;
      background: #fff;
      border-radius: 50%;
      top: 2px;
      left: 2px;
    }

    .bunny-nose {
      position: absolute;
      width: 10px;
      height: 7px;
      background: #ffb6c1;
      border-radius: 50%;
      bottom: 32px;
      left: 50%;
      transform: translateX(-50%);
    }

    .bunny-mouth {
      position: absolute;
      bottom: 22px;
      left: 50%;
      transform: translateX(-50%);
      width: 16px;
      height: 8px;
      border-bottom: 2px solid #d4919e;
      border-radius: 0 0 50% 50%;
    }

    .bunny-cheek-l, .bunny-cheek-r {
      position: absolute;
      width: 16px;
      height: 10px;
      background: #ffc2d1;
      border-radius: 50%;
      bottom: 28px;
      opacity: 0.6;
      transition: all 0.3s;
    }

    .bunny-cheek-l { left: 14px; }
    .bunny-cheek-r { right: 14px; }

    @keyframes bunnyBounce {
      0%, 100% { transform: translateY(0); }
      50%      { transform: translateY(-15px); }
    }

    h1 {
      font-family: 'Caveat', cursive;
      font-size: clamp(2.5rem, 8vw, 4.5rem);
      font-weight: 600;
      margin-bottom: 0.3rem;
      background: linear-gradient(135deg, #ff758f, #ff4d6d, #ff85a1, #ffc2d1);
      background-size: 300% 300%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: shimmer 4s ease-in-out infinite;
      letter-spacing: 1px;
    }

    @keyframes shimmer {
      0%, 100% { background-position: 0% 50%; }
      50%      { background-position: 100% 50%; }
    }

    .subtitle {
      font-family: 'Caveat', cursive;
      font-size: clamp(1.2rem, 3.5vw, 1.6rem);
      color: #c47a90;
      margin-bottom: 2rem;
      opacity: 0;
      animation: fadeInUp 1s ease forwards 0.5s;
      line-height: 1.6;
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* Buttons */
    .buttons {
      display: flex;
      gap: 1.5rem;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      opacity: 0;
      animation: fadeInUp 1s ease forwards 1s;
    }

    .btn-yes {
      padding: 16px 52px;
      background: linear-gradient(135deg, #ff85a1, #ff4d6d);
      color: #fff;
      border: none;
      border-radius: 50px;
      font-family: 'Caveat', cursive;
      font-size: 1.5rem;
      cursor: pointer;
      letter-spacing: 1px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 20px rgba(255, 77, 109, 0.3);
    }

    .btn-yes:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 30px rgba(255, 77, 109, 0.5);
    }

    .btn-no {
      padding: 12px 32px;
      background: #fff;
      color: #b07a8a;
      border: 2px solid #e8b4c8;
      border-radius: 50px;
      font-family: 'Caveat', cursive;
      font-size: 1.2rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    /* Music toggle */
    .music-toggle {
      position: fixed;
      top: 1.2rem;
      right: 1.2rem;
      z-index: 500;
      background: rgba(255, 255, 255, 0.85);
      border: 2px solid #e8b4c8;
      border-radius: 50%;
      width: 44px;
      height: 44px;
      cursor: pointer;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      backdrop-filter: blur(8px);
      color: #ff85a1;
    }

    .music-toggle:hover { transform: scale(1.1); background: #fff; }

    /* Yes response */
    .yes-screen {
      display: none;
      text-align: center;
      width: 100%;
      max-width: 1200px;
      padding: 2rem 1rem;
    }

    .yes-screen.active {
      display: block;
      animation: fadeInUp 0.8s ease forwards;
    }

    .yes-text {
      font-family: 'Caveat', cursive;
      font-size: clamp(2rem, 6vw, 3.5rem);
      background: linear-gradient(135deg, #ff758f, #ffc2d1, #ff4d6d);
      background-size: 300% 300%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: shimmer 3s ease-in-out infinite;
      margin-top: 0.5rem;
      line-height: 1.4;
    }

    .yes-sub {
      font-family: 'Caveat', cursive;
      color: #c47a90;
      font-size: clamp(1.2rem, 3vw, 1.5rem);
      margin-top: 0.8rem;
    }

    /* Love notes section */
    .love-notes {
      margin: 3rem auto 2rem;
      max-width: 700px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.2rem;
      padding: 0 1rem;
    }

    .love-note {
      background: #fff;
      border-radius: 16px;
      padding: 1.5rem 1.2rem;
      font-family: 'Caveat', cursive;
      font-size: 1.2rem;
      color: #7a4a5a;
      box-shadow: 0 4px 16px rgba(180, 120, 140, 0.12);
      transform: rotate(var(--rot, -2deg));
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      opacity: 0;
      animation: noteIn 0.5s ease forwards;
      position: relative;
      line-height: 1.4;
    }

    .love-note::before {
      content: '';
      position: absolute;
      top: -6px;
      left: 50%;
      transform: translateX(-50%);
      width: 40px;
      height: 14px;
      background: rgba(255, 182, 193, 0.5);
      border-radius: 2px;
    }

    .love-note:hover {
      transform: rotate(0deg) scale(1.05);
      box-shadow: 0 8px 25px rgba(255, 133, 161, 0.25);
    }

    @keyframes noteIn {
      from { opacity: 0; transform: rotate(var(--rot, -2deg)) translateY(20px) scale(0.9); }
      to { opacity: 1; transform: rotate(var(--rot, -2deg)) translateY(0) scale(1); }
    }

    .love-notes-title {
      font-family: 'Caveat', cursive;
      font-size: clamp(1.5rem, 4vw, 2.2rem);
      color: #ff85a1;
      margin-bottom: 0.3rem;
      letter-spacing: 1px;
    }

    .love-notes-sub {
      font-family: 'Caveat', cursive;
      color: #c47a90;
      font-size: 1.1rem;
      margin-bottom: 1rem;
    }

    /* Photo gallery - Polaroid style */
    .gallery-title {
      font-family: 'Caveat', cursive;
      font-size: clamp(1.5rem, 4vw, 2.2rem);
      color: #ff85a1;
      margin: 2rem 0 0.3rem;
      letter-spacing: 1px;
    }

    .gallery-sub {
      font-family: 'Caveat', cursive;
      color: #c47a90;
      font-size: 1.1rem;
      margin-bottom: 1.5rem;
    }

    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 2rem;
      width: 100%;
      padding: 0 1rem 3rem;
    }

    .polaroid {
      background: #fff;
      border-radius: 4px;
      padding: 12px 12px 0 12px;
      box-shadow: 0 4px 20px rgba(180, 120, 140, 0.15);
      transform: rotate(var(--rot, 0deg));
      transition: transform 0.4s ease, box-shadow 0.4s ease;
      cursor: pointer;
      opacity: 0;
      animation: polaroidIn 0.6s ease forwards;
    }

    .polaroid:hover {
      transform: rotate(0deg) scale(1.04) translateY(-5px);
      box-shadow: 0 12px 35px rgba(255, 133, 161, 0.3);
    }

    .polaroid img {
      width: 100%;
      aspect-ratio: 1;
      object-fit: cover;
      display: block;
      border-radius: 2px;
    }

    .polaroid-caption {
      font-family: 'Caveat', cursive;
      font-size: 1.1rem;
      color: #7a4a5a;
      padding: 10px 4px 14px;
      text-align: center;
      min-height: 44px;
      line-height: 1.3;
    }

    @keyframes polaroidIn {
      from { opacity: 0; transform: rotate(var(--rot, 0deg)) translateY(40px) scale(0.9); }
      to { opacity: 1; transform: rotate(var(--rot, 0deg)) translateY(0) scale(1); }
    }

    /* Lightbox */
    .lightbox {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(90, 62, 75, 0.92);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      padding: 2rem;
      backdrop-filter: blur(5px);
    }

    .lightbox.active { display: flex; flex-direction: column; }

    .lightbox img {
      max-width: 90vw;
      max-height: 75vh;
      border-radius: 8px;
      box-shadow: 0 0 60px rgba(255, 133, 161, 0.3);
      animation: lightboxIn 0.3s ease;
      border: 6px solid #fff;
    }

    .lightbox-caption {
      font-family: 'Caveat', cursive;
      color: #ffc2d1;
      font-size: 1.4rem;
      margin-top: 1rem;
      text-align: center;
    }

    @keyframes lightboxIn {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    .lightbox-close {
      position: fixed;
      top: 1.5rem;
      right: 2rem;
      font-size: 2rem;
      color: #ffc2d1;
      cursor: pointer;
      z-index: 1001;
      transition: transform 0.2s;
    }

    .lightbox-close:hover { transform: scale(1.2); }

    .lightbox-nav {
      position: fixed;
      top: 50%;
      transform: translateY(-50%);
      font-size: 2.5rem;
      color: #ffc2d1;
      cursor: pointer;
      z-index: 1001;
      padding: 1rem;
      transition: transform 0.2s;
      user-select: none;
    }

    .lightbox-nav:hover { transform: translateY(-50%) scale(1.2); }
    .lightbox-prev { left: 1rem; }
    .lightbox-next { right: 1rem; }

    /* Confetti canvas */
    #confetti {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 10;
    }

    /* Scroll hint */
    .scroll-hint {
      margin-top: 2rem;
      color: #c47a90;
      font-family: 'Caveat', cursive;
      font-size: 1.1rem;
      animation: bounce 2s ease-in-out infinite;
    }

    .scroll-hint span { display: block; font-size: 1.8rem; }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50%      { transform: translateY(8px); }
    }

    /* Divider */
    .cute-divider {
      margin: 1rem auto;
      font-family: 'Caveat', cursive;
      color: #e8b4c8;
      font-size: 1.5rem;
      letter-spacing: 8px;
    }

    @media (max-width: 600px) {
      .gallery {
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
      }
      .love-notes {
        grid-template-columns: 1fr;
      }
      .keroppi { transform: scale(0.8); }
      .bunny { transform: scale(0.85); }
      .polaroid { padding: 8px 8px 0 8px; }
      .polaroid-caption { font-size: 0.95rem; padding: 8px 2px 10px; }
    }
  </style>
</head>
<body>
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>
  <div class="orb orb-3"></div>
  <div class="orb orb-4"></div>
  <div class="floaters-bg" id="floatersBg"></div>
  <canvas id="confetti"></canvas>
  <button class="music-toggle" id="musicToggle" title="Toggle music">&#9835;</button>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox">
    <div class="lightbox-close" onclick="closeLightbox()">&times;</div>
    <div class="lightbox-nav lightbox-prev" onclick="navLightbox(-1)">&#10094;</div>
    <div class="lightbox-nav lightbox-next" onclick="navLightbox(1)">&#10095;</div>
    <img id="lightboxImg" src="" alt="">
    <div class="lightbox-caption" id="lightboxCaption"></div>
  </div>

  <!-- Ask screen -->
  <div class="content" id="askScreen">
    <div class="keroppi">
      <div class="keroppi-body">
        <div class="keroppi-eye-l"><div class="keroppi-pupil-l"></div></div>
        <div class="keroppi-eye-r"><div class="keroppi-pupil-r"></div></div>
        <div class="keroppi-mouth"></div>
        <div class="keroppi-cheek-l"></div>
        <div class="keroppi-cheek-r"></div>
      </div>
    </div>

    <div class="bunny">
      <div class="bunny-head">
        <div class="bunny-ear-l"></div>
        <div class="bunny-ear-r"></div>
        <div class="bunny-ear-inner-l"></div>
        <div class="bunny-ear-inner-r"></div>
        <div class="bunny-eye-l"></div>
        <div class="bunny-eye-r"></div>
        <div class="bunny-nose"></div>
        <div class="bunny-mouth"></div>
        <div class="bunny-cheek-l"></div>
        <div class="bunny-cheek-r"></div>
      </div>
    </div>

    <h1>Will You Be My Valentine?</h1>
    <p class="subtitle">I like you more than carrots... and that's saying a lot.</p>

    <div class="buttons">
      <button class="btn-yes" id="yesBtn" onclick="sayYes()">Yes please!</button>
      <button class="btn-no" id="noBtn">No</button>
    </div>
  </div>

  <!-- Yes response -->
  <div class="content yes-screen" id="yesScreen">
    <div class="keroppi" style="margin-bottom:0.5rem">
      <div class="keroppi-body">
        <div class="keroppi-eye-l"><div class="keroppi-pupil-l"></div></div>
        <div class="keroppi-eye-r"><div class="keroppi-pupil-r"></div></div>
        <div class="keroppi-mouth"></div>
        <div class="keroppi-cheek-l"></div>
        <div class="keroppi-cheek-r"></div>
      </div>
    </div>

    <div class="yes-text">You said yes!!<br>I'm the luckiest bunny alive</div>
    <div class="yes-sub">okay but fr you just made my whole year</div>

    <div class="scroll-hint">
      <span>&#x2193;</span>
      keep scrolling, it gets cuter
    </div>

    <!-- Love notes -->
    <div class="cute-divider">~ ~ ~</div>
    <p class="love-notes-title">Things I Love About You</p>
    <p class="love-notes-sub">a very incomplete list</p>

    <div class="love-notes" id="loveNotes"></div>

    <!-- Photo gallery -->
    <div class="cute-divider">~ ~ ~</div>
    <p class="gallery-title">Us Being Cute Together</p>
    <p class="gallery-sub">every single one is my favorite</p>

    <div class="gallery" id="gallery"></div>
  </div>

  <script>
    const floatersBg = document.getElementById('floatersBg');
    const noBtn = document.getElementById('noBtn');
    const yesBtn = document.getElementById('yesBtn');
    let noCount = 0;
    let currentLightboxIndex = 0;
    let musicPlaying = false;
    let audioCtx = null;

    const photos = [
      'images/IMG_0669.JPG', 'images/IMG_2442.JPG', 'images/IMG_2453.jpg',
      'images/IMG_2460.jpg', 'images/IMG_2464.jpg', 'images/IMG_2970.jpg',
      'images/IMG_3044.jpg', 'images/IMG_3102.jpg', 'images/IMG_3205.jpg',
      'images/IMG_3515.jpg', 'images/IMG_3555.jpg', 'images/IMG_4379.jpg',
      'images/IMG_4867.jpg', 'images/IMG_5163.jpg', 'images/IMG_5475.jpg',
      'images/IMG_7189.jpg', 'images/IMG_7642.jpg', 'images/IMG_7683.jpg',
      'images/IMG_7698.jpg', 'images/IMG_7762.jpg', 'images/IMG_7800.jpg',
      'images/IMG_8149.jpg', 'images/IMG_8703.jpg', 'images/IMG_8716.jpg',
      'images/IMG_8866.jpg', 'images/IMG_9324.jpg', 'images/SAM_1908.JPG',
      'images/3A97D64F.jpg', 'images/RenderedImage.jpg',
    ];

    // Cute captions for polaroids
    const captions = [
      "you + me = everything",
      "my favorite hello",
      "you make me smile like this",
      "this is my happy place",
      "us being us",
      "you're my person",
      "still can't believe you're mine",
      "main character energy, both of us",
      "10/10 would do life with you",
      "the way you look at me tho",
      "my heart goes brrr",
      "certified cuties",
      "you had me at hello",
      "together is my favorite place",
      "falling for you, still",
      "you're stuck with me now",
      "the best plot twist in my life",
      "we're that couple and I love it",
      "you make boring fun",
      "my forever plus one",
      "I like your face a lot",
      "can we stay like this forever",
      "you're the reason I smile",
      "lucky me, lucky us",
      "my whole heart, right here",
      "I'd choose you every time",
      "home is wherever you are",
      "we just make sense",
      "the cutest memory",
    ];

    const loveNoteTexts = [
      "The way you laugh at my terrible jokes like they're actually funny",
      "How you always know exactly what I need before I even say it",
      "Your smile literally makes everything better, it's unfair",
      "The fact that you put up with my chaos and still choose me every day",
      "How safe I feel when I'm with you, like nothing else matters",
      "Your voice when you're sleepy... it does things to my heart",
      "The way you hold my hand like you never want to let go",
      "How you make even the most boring days feel like an adventure",
    ];

    // Shuffle photos + captions together
    const paired = photos.map((p, i) => ({ photo: p, caption: captions[i % captions.length] }));
    for (let i = paired.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [paired[i], paired[j]] = [paired[j], paired[i]];
    }

    const noMessages = [
      'No',
      'wait... really?',
      'are you sure about that?',
      'think about it...',
      'pretty please?',
      'with a cherry on top?',
      'i\'ll share my fries...',
      'i\'ll let you pick the movie...',
      'you\'re really doing this to me',
      'my bunny heart is breaking',
      'ok last chance... pls?',
    ];

    // No button
    noBtn.addEventListener('click', () => {
      noCount++;
      noBtn.textContent = noMessages[Math.min(noCount, noMessages.length - 1)];
      noBtn.style.transform = `scale(${Math.max(0.4, 1 - noCount * 0.08)})`;
      yesBtn.style.transform = `scale(${1 + noCount * 0.15})`;
      yesBtn.style.fontSize = `${1.5 + noCount * 0.12}rem`;
      const maxX = window.innerWidth - noBtn.offsetWidth - 40;
      const maxY = window.innerHeight - noBtn.offsetHeight - 40;
      noBtn.style.position = 'fixed';
      noBtn.style.left = Math.floor(Math.random() * maxX) + 'px';
      noBtn.style.top = Math.floor(Math.random() * maxY) + 'px';
      noBtn.style.zIndex = '100';
    });

    function sayYes() {
      document.getElementById('askScreen').style.display = 'none';
      noBtn.style.display = 'none';
      document.body.style.overflow = 'auto';
      document.getElementById('yesScreen').classList.add('active');
      for (let i = 0; i < 30; i++) setTimeout(() => createFloater(), i * 80);
      launchConfetti();
      buildLoveNotes();
      buildGallery();
    }

    // Love notes
    function buildLoveNotes() {
      const container = document.getElementById('loveNotes');
      loveNoteTexts.forEach((text, i) => {
        const note = document.createElement('div');
        note.classList.add('love-note');
        const rot = (Math.random() - 0.5) * 6;
        note.style.setProperty('--rot', `${rot}deg`);
        note.style.animationDelay = `${i * 0.12}s`;
        note.textContent = text;
        container.appendChild(note);
      });
    }

    // Polaroid gallery
    function buildGallery() {
      const gallery = document.getElementById('gallery');
      paired.forEach(({ photo, caption }, i) => {
        const pol = document.createElement('div');
        pol.classList.add('polaroid');
        const rot = (Math.random() - 0.5) * 5;
        pol.style.setProperty('--rot', `${rot}deg`);
        pol.style.animationDelay = `${i * 0.08}s`;
        pol.innerHTML = `
          <img src="${photo}" alt="Our memory" loading="lazy">
          <div class="polaroid-caption">${caption}</div>
        `;
        pol.addEventListener('click', () => openLightbox(i));
        gallery.appendChild(pol);
      });
    }

    // Lightbox
    function openLightbox(index) {
      currentLightboxIndex = index;
      document.getElementById('lightboxImg').src = paired[index].photo;
      document.getElementById('lightboxCaption').textContent = paired[index].caption;
      document.getElementById('lightbox').classList.add('active');
    }

    function closeLightbox() {
      document.getElementById('lightbox').classList.remove('active');
    }

    function navLightbox(dir) {
      event.stopPropagation();
      currentLightboxIndex = (currentLightboxIndex + dir + paired.length) % paired.length;
      document.getElementById('lightboxImg').src = paired[currentLightboxIndex].photo;
      document.getElementById('lightboxCaption').textContent = paired[currentLightboxIndex].caption;
    }

    document.getElementById('lightbox').addEventListener('click', (e) => {
      if (e.target === e.currentTarget) closeLightbox();
    });

    document.addEventListener('keydown', (e) => {
      if (!document.getElementById('lightbox').classList.contains('active')) return;
      if (e.key === 'Escape') closeLightbox();
      if (e.key === 'ArrowLeft') navLightbox(-1);
      if (e.key === 'ArrowRight') navLightbox(1);
    });

    // Floating bunnies
    function createFloater() {
      const wrapper = document.createElement('div');
      wrapper.classList.add('floating-bunny');
      const size = 0.5 + Math.random() * 0.7;
      wrapper.style.left = Math.random() * 100 + '%';
      wrapper.style.animationDuration = (10 + Math.random() * 12) + 's';
      wrapper.style.transform = `scale(${size})`;
      wrapper.innerHTML = `<div class="mini-bunny"><div class="ear-inner-l"></div><div class="ear-inner-r"></div></div>`;
      floatersBg.appendChild(wrapper);
      setTimeout(() => wrapper.remove(), 22000);
    }

    for (let i = 0; i < 6; i++) setTimeout(() => createFloater(), i * 700);
    setInterval(createFloater, 2500);

    // Sparkle cursor trail
    let lastSparkle = 0;
    document.addEventListener('mousemove', (e) => {
      const now = Date.now();
      if (now - lastSparkle < 50) return;
      lastSparkle = now;
      const sparkle = document.createElement('div');
      sparkle.classList.add('sparkle-trail');
      sparkle.style.left = e.clientX + (Math.random() - 0.5) * 10 + 'px';
      sparkle.style.top = e.clientY + (Math.random() - 0.5) * 10 + 'px';
      const size = 3 + Math.random() * 5;
      sparkle.style.width = size + 'px';
      sparkle.style.height = size + 'px';
      document.body.appendChild(sparkle);
      setTimeout(() => sparkle.remove(), 600);
    });

    // Confetti
    function launchConfetti() {
      const canvas = document.getElementById('confetti');
      const ctx = canvas.getContext('2d');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      const pieces = [];
      const colors = ['#ffb6c1', '#ffc2d1', '#ffd6e0', '#98d4a2', '#b8e6be', '#fff', '#ff85a1', '#ffe4ec'];
      for (let i = 0; i < 250; i++) {
        pieces.push({
          x: canvas.width / 2, y: canvas.height / 2,
          vx: (Math.random() - 0.5) * 24, vy: (Math.random() - 0.5) * 24 - 6,
          w: 5 + Math.random() * 8, h: 3 + Math.random() * 6,
          color: colors[Math.floor(Math.random() * colors.length)],
          rot: Math.random() * 360, rotSpeed: (Math.random() - 0.5) * 15,
          gravity: 0.12 + Math.random() * 0.1, opacity: 1,
        });
      }
      function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        let alive = false;
        for (const p of pieces) {
          p.vy += p.gravity; p.x += p.vx; p.y += p.vy;
          p.rot += p.rotSpeed; p.vx *= 0.99; p.opacity -= 0.0025;
          if (p.opacity <= 0) continue;
          alive = true;
          ctx.save();
          ctx.translate(p.x, p.y);
          ctx.rotate((p.rot * Math.PI) / 180);
          ctx.globalAlpha = p.opacity;
          ctx.fillStyle = p.color;
          ctx.fillRect(-p.w / 2, -p.h / 2, p.w, p.h);
          ctx.restore();
        }
        if (alive) requestAnimationFrame(animate);
      }
      animate();
    }

    window.addEventListener('resize', () => {
      const c = document.getElementById('confetti');
      c.width = window.innerWidth;
      c.height = window.innerHeight;
    });

    // Music Box
    let musicInterval = null;
    let gainNode = null;

    function startMusic() {
      if (audioCtx) { audioCtx.resume(); musicPlaying = true; updateMusicBtn(); return; }
      audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      gainNode = audioCtx.createGain();
      gainNode.gain.value = 0.1;
      gainNode.connect(audioCtx.destination);

      const melody = [
        { note: 'E5', dur: 0.25 }, { note: 'G5', dur: 0.25 },
        { note: 'A5', dur: 0.5 },  { note: 'G5', dur: 0.25 },
        { note: 'E5', dur: 0.25 }, { note: 'D5', dur: 0.5 },
        { note: 'C5', dur: 0.25 }, { note: 'D5', dur: 0.25 },
        { note: 'E5', dur: 0.5 },  { note: 'G5', dur: 0.25 },
        { note: 'E5', dur: 0.25 }, { note: 'D5', dur: 0.5 },
        { note: 'E5', dur: 0.25 }, { note: 'G5', dur: 0.25 },
        { note: 'A5', dur: 0.25 }, { note: 'B5', dur: 0.25 },
        { note: 'A5', dur: 0.5 },  { note: 'G5', dur: 0.5 },
        { note: 'E5', dur: 0.25 }, { note: 'D5', dur: 0.25 },
        { note: 'C5', dur: 0.75 }, { note: 'R', dur: 0.75 },
        { note: 'C5', dur: 0.25 }, { note: 'E5', dur: 0.25 },
        { note: 'G5', dur: 0.5 },  { note: 'A5', dur: 0.25 },
        { note: 'G5', dur: 0.25 }, { note: 'E5', dur: 0.5 },
        { note: 'D5', dur: 0.25 }, { note: 'E5', dur: 0.25 },
        { note: 'G5', dur: 0.5 },  { note: 'E5', dur: 0.25 },
        { note: 'D5', dur: 0.25 }, { note: 'C5', dur: 0.5 },
        { note: 'A4', dur: 0.25 }, { note: 'C5', dur: 0.25 },
        { note: 'E5', dur: 0.5 },  { note: 'D5', dur: 0.25 },
        { note: 'C5', dur: 0.25 }, { note: 'D5', dur: 0.5 },
        { note: 'E5', dur: 0.25 }, { note: 'G5', dur: 0.25 },
        { note: 'A5', dur: 0.75 }, { note: 'R', dur: 0.75 },
      ];

      const freq = {
        'A4': 440, 'C5': 523.25, 'D5': 587.33,
        'E5': 659.26, 'G5': 783.99, 'A5': 880, 'B5': 987.77,
      };
      const tempo = 0.3;

      function play() {
        let t = audioCtx.currentTime + 0.05;
        melody.forEach(({ note, dur }) => {
          const d = dur * tempo;
          if (note !== 'R') {
            const o = audioCtx.createOscillator();
            const g = audioCtx.createGain();
            o.type = 'sine';
            o.frequency.value = freq[note];
            g.gain.setValueAtTime(0.5, t);
            g.gain.exponentialRampToValueAtTime(0.01, t + d * 2.5);
            o.connect(g); g.connect(gainNode);
            o.start(t); o.stop(t + d * 3);

            const o2 = audioCtx.createOscillator();
            const g2 = audioCtx.createGain();
            o2.type = 'sine';
            o2.frequency.value = freq[note] * 3;
            g2.gain.setValueAtTime(0.06, t);
            g2.gain.exponentialRampToValueAtTime(0.001, t + d * 1.5);
            o2.connect(g2); g2.connect(gainNode);
            o2.start(t); o2.stop(t + d * 2);
          }
          t += d;
        });
        return t - audioCtx.currentTime;
      }

      const dur = play();
      musicInterval = setInterval(() => { if (musicPlaying) play(); }, dur * 1000);
      musicPlaying = true;
      updateMusicBtn();
    }

    function stopMusic() { if (audioCtx) audioCtx.suspend(); musicPlaying = false; updateMusicBtn(); }

    function updateMusicBtn() {
      document.getElementById('musicToggle').innerHTML = musicPlaying ? '&#9835;' : '&#9834;';
      document.getElementById('musicToggle').style.opacity = musicPlaying ? '1' : '0.5';
    }

    document.getElementById('musicToggle').addEventListener('click', () => {
      musicPlaying ? stopMusic() : startMusic();
    });

    let musicStarted = false;
    document.addEventListener('click', () => {
      if (!musicStarted) { musicStarted = true; startMusic(); }
    }, { once: false });
  </script>
</body>
</html>
